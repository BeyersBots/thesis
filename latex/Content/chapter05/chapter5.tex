\documentclass[12pt,letterpaper,oneside]{book}
\usepackage{../../afitStyleFiles/afitThesis}
\usepackage[nolist]{acronym}
\usepackage{todo}
\usepackage{tabu}
\usepackage{makecell}
\renewcommand\theadfont{\bfseries}
\graphicspath{{../../Figures/}}
\input{../Preamble/myFigures}
\input{../Preamble/myTables}
\usepackage[outdir=./]{epstopdf}

\begin{document}
	\begin{acronym}
		\acro {BLE} {Bluetooth Low Energy}
		\acro {SIG} {Special Interest Group}
		\acro {BR/EDR} {Basic Rate/Enhanced Data Rate}
		\acro {IoT} {internet of things}
		\acro {CI} {critical infrastructure}
		\acro {WSN} {Wireless Sensor Network}
		\acro {ATT} {Attribute Protocol}
		\acro {GATT} {Generic Attribute Profile}
		\acro {SM} {Security Manager}
		\acro {LTK} {Long Term Key}
		\acro {CSRK} {Connection Signature Resolving Key}
		\acro {IRK} {Identity Resolving Key}
		\acro {AES} {Advanced Encryption Standard}
		\acro {TK} {Temporary Key}
		\acro {STK} {Short-Term Key}
		\acro {ECDH} {Elliptic Curve Diffie Hellman}
		\acro {CE} {Connection Events}
		\acro {CRC} {Cyclic Redundancy Check}
		\acro {SCA} {sleep clock accuracy}
		\acro {RSSI} {Received Signal Strength Indicator}
		\acro {MAC} {Media Access Control}
		\acro {CRM} {Customer Relationship Management}
		\acro {SSID} {Service Set Identifiers}
		\acro {AP} {access point}
	\end{acronym}
	\mainmatter
	\chapter{Results and Analysis}
	
	\section{Overview}
	This section describes the results obtained using \ac{CITIoT} during the experimentation described in Chapter 4. Results are discussed in four configurations: (i) \ac{BLE}, (ii) Wi-Fi with no mitigation, (iii) combined \ac{BLE} and Wi-Fi with no mitigation, and (iv) Wi-Fi with mitigation. Configurations three and four are used when analyzing \ac{CITIoT}'s overall accuracy and performance. Section~\ref{citiotAccuracy} discusses the accuracy of \ac{CITIoT} by examining the applicable metrics. The performance of \ac{CITIoT}, as defined by the \ac{PT} and \ac{HDU} response variables, is reported in Section~\ref{citiotPerformance}. Alibis are provided for each failure and results are discussed to provide insight into smart home leakage and its security ramifications.
	
	\section{CITIoT Accuracy} \label{citiotAccuracy}
	This section analyzes \ac{CITIoT}'s accuracy against \ac{SHAA} (discussed in Section 4.7) using the response variables \ac{DCSR}, \ac{EISR}, \ac{EIFP}, \ac{EIFN}, and \ac{ULSR}. Results are presented for all four configurations and are calculated using the script presented in Appendix~\ref{}. The script compares a trial's event identification output from \ac{CITIoT} with the logs to provide a list of true positives, false positives, and false negatives. The script also calculates the values for each of the response variables per trial and configuration.
	
	Tables~\ref{},~\ref{},~\ref{}, and~\ref{} provide results from experiment trials for each configuration respectively. The R script in Appendix~\ref{} produced the plots provided in Appendix~\ref{} and Appendix~\ref{}. The first set of plots consist of four scatter plots per trial day in which \ac{MIoTL} was not operating: a plot for the entire day, the morning, the afternoon, and the evening with each showing logged and identified \ac{BLE} and Wi-Fi events. The second set of plots include one scatter plot per trial day in which \ac{MIoTL} was operating. As depicted in the example plot provided in Figure~\ref{}, a point with a star and circle depicts a true positive (the tool successfully identified an event), a point with only a circle represents a false negative (the tool failed to identify an event), and a point with only a star shows a false positive (the tool identified an event that did not occur). The R script also calculates the standard deviation and 95\% confidence interval for each response variable. Table~\ref{} summarizes the mean results of \ac{CITIoT}'s accuracy across all trials in each configuration. User tracking is only accomplished via Wi-Fi devices, therefore, the \ac{ULSR} of \ac{BLE} trials is not considered. The rest of this section discusses and analyzes the significance of each of the response variables pertinent to the tool's accuracy.
	
	%\tableBleResults
	%\tableWifiResults
	%\tableCombinedResults
	%\tableMitigationResults
	%\figExamplePlot
	%\tableTotalResults	
	
	\subsection{\ac{DCSR}}
	The \ac{DCSR} response variable, as presented in Section 4.3, measures \ac{CITIoT}'s ability to accurately classify devices within \ac{SHAA}. Table~\ref{} provides the overall mean success rate for each configuration while Appendix~\ref{} supplies the tool's device classification output. The \ac{CITIoT} tool classified \ac{BLE} devices with a success rate of 75.0\% per trial. The Bike Lock, Apple iPhone 6+, and Apple TV were not identifiable via \ac{BLE} traffic from the smart home. The Bike Lock used a pseudonym as a device name "00000b67", while both Apple devices did not provide a device name and the \ac{BLE} \ac{MAC} addresses were randomized. Without mitigation active, the tool successfully classified all 8 Wi-Fi devices providing a 100\% success rate. Of the total 18 \ac{IoT} devices employed within \ac{SHAA}, the tool was able to identify 17 using one of the wireless protocols for an overall success rate of 94.4\%. With mitigation employed, however, the tool was only able to classify 6 out of 8 Wi-Fi devices for a success rate of 75\%. The traffic spoofed by \ac{MIoTL} caused \ac{CITIoT} to categorize each device as an outlet. This feature of \ac{MIoTL} hides the existence of motion sensors and cameras within the smart home from an eavesdropper using \ac{CITIoT}.  The success rates were consistent across all trials for each configuration, therefore the standard deviation of this response variable is not significant.
	
	%		\tableDcsrResults
	
	\subsection{\ac{EISR}}
	The \ac{EISR} response variable defined in Section 4.3, measures \ac{CITIoT}'s true positive rate, or the ability of the tool to successfully identify events that occur in \ac{SHAA}. An event is correctly identified if the time and device of the event recognized matches an event in the log. For sensor, camera, and \ac{BLE} events, an event is considered successful if it the identified time is $\pm$1 minute from the log time. This success interval provides enough precision for the problem presented in this thesis. Table~\ref{} provides the overall mean \ac{EISR} results for each configuration. Appendix~\ref{} supplies the tool's event identification output listing each event successfully identified. Over all trials, \ac{CITIoT} identified 162 out of 170 \ac{BLE} events for a mean \ac{EISR} of 94.9\%. For trials without mitigation, \ac{CITIoT} identified 162 out of 173 Wi-Fi events for a mean \ac{EISR} of 93.7\%.  For \ac{BLE} and Wi-Fi trials combined without mitigation, the tool identified a total 324 out of 343 events for a mean \ac{EISR} of 95.0\%. For Wi-Fi trials with mitigation, the tool identified a total of X out of X events for a mean \ac{EISR} of X\%. The standard deviations and 95\% confidence intervals, listed in Table~\ref{}, show that the \ac{EISR} for each trial was close to the mean of all trials per configuration. This provides a high confidence that the tool can consistently identify events at a combined rate greater than 90\% when \ac{MIoTL} is not operating. \ac{CITIoT} was still effective in identifying events during mitigation and still operated at a success rate greater than 90\%.
	
	%\tableEisrResults
	
	\subsection{\ac{EIFP}}
	The \ac{EIFP} response variable described in Section 4.3, measures \ac{CITIoT}'s false positive rate, or the rate at which the tool identifies events that did not occur in \ac{SHAA}. An event is a false positive if there is no corresponding entry in the logs. Table~\ref{} provides the overall mean \ac{EIFP} results for each configuration. Appendix~\ref{} supplies the tool's event identification false positives for each trial. 
	
	Of the 176 \ac{BLE} events identified by \ac{CITIoT}, 8 did not occur providing a mean \ac{EIFP} rate of 4.1\%. \ac{BLE} false positives occur because \ac{CITIoT} identifies events based off of connection requests sent from a master to a slave which may occur outside of smart home events. For example, a phone and a temperature sensor might create a connection to pass battery information that \ac{CITIoT} would mistakingly identify as a smart home event. Of the false postives, all 8 were from one of the Eve devices and the wireless traffic is encrypted.
	
	For trials without mitigation, 5 Wi-Fi events did not occur out of the 166 identified for a mean \ac{EIFP} of 2.9\%. All 5 false positives were either motion or camera events. The \ac{CITIoT} tool identifies these type of events by summing the total number of packets sent within a minute. If the sum of these packets reaches a threshold, then an event is identified. After traffic analysis, it was observed that these false positives occur when the two devices send enought packets in a minute to trigger \ac{CITIoT} to falsely identify an event. The wireless traffic is encrypted so it is unclear if these false positives were caused by actual events that failed to report to the Homebridge log or other status traffic. The mean \ac{EIFP} of 2.9\%, however, is well within the desired results.
	
	A combined 13 of the 342 events identified did not occur resulting in a mean \ac{EIFP} rate of 3.2\%. With mitigation, however, X out of X total events identified by \ac{CITIoT} were false positives providing a mean \ac{EIFP} rate of X\%. The standard deviations and 95\% confidence intervals, provided in Table~\ref{}, show that the \ac{EIFP} for each trial was consistent to the mean of all trials per configuration. Therefore, without mitigation \ac{CITIoT} consistently produces false positives with a combined rate less than 7\%. The \ac{BLE} \ac{EIFP} rate was higher than Wi-Fi and indicates that portion of the identifier may need to be altered. Mitigation increased the \ac{EIFP} rate for Wi-Fi devices to X\% and made \ac{CITIoT} ineffective at differentiating real events from spoofed events.
	
	%\tableEifpResults
	
	\subsection{\ac{EIFN}}
	The \ac{EIFN} response variable, as provided in Section 4.3, measures \ac{CITIoT}'s false negative rate, or the rate at which the tool fails to identify events that occur in \ac{SHAA}. Table~\ref{} provides the \ac{EIFN} results for each configuration. Appendix~\ref{} supplies the tool's event identification output listing each false negative. 
	
	\ac{CITIoT} failed to identify 8 \ac{BLE} events from the 170 total events resulting in a 5.2\% mean \ac{EIFN} rate. There are three primary reasons the tool can fail to identify a \ac{BLE} event: first, the connection request packet sent by the master may not be collected by the sniffers due to wireless interference; second, the connection request packet may have been collected by the sniffers, but corrupted; and third, the sniffer set to listen on the advertisement channel that a connect request packet was sent may already be following a different connection and, therefore, would not collect the connect request packet. The cause of a false negative can be determined via traffic analysis. The lack of connection events around the time of an event can indicate the first cause. A malformed connect request packet at the time of an event can point towards the second cause. If a sniffer is following a connection at the time of an unidentified event can suggest the third reason. Traffic analysis of the 8 false negatives indicates that four of the events were probably caused by interference, while the other four could have been a result of the Ubertooth One sniffers following other connections.
	
	Without mitigation, a total of 11 out of 173 Wi-Fi events were not identified for a mean \ac{EIFN} of 6.3\%. The main reason the tool may fail to identify event is if the Alfa Card sniffer fails to capture the packet sent from the Rapberry Pi to a device due to congestion. There is no way to guarantee the cause, but the traffic analysis indicates this was the cause for all 11 false negatives.
	
	Combined with no mitigation, the tool failed to identify 19 of 342 events for a mean \ac{EIFN} rate of 5.1\% across all trials. With mitigation, X out of X events were not identified by \ac{CITIoT} resulting in a mean \ac{EIFN} rate of X\%. The standard deviations and 95\% confidence interval, provided in Table~\ref{}, suggest that the \ac{EIFN} for each trial was consistent to the mean of all trials per configuration. Therefore, without mitigation \ac{CITIoT} consistently fails to identify events at a rate less than 10\%. 
	
	%		\tableEifnResults
	
	\subsection{\ac{ULSR}}
	The \ac{ULSR} response variable measures the rate at which \ac{CITIoT} accurately determines if a user is in the smart house or not. Tracking is accomplished via Wi-Fi wireless traffic, so there are no results from the \ac{BLE} configuration. Without mitigation, the tool successfully tracked the user's location for all but 9 minutes out of 51 hours and 49 minutes. This resulted in a mean \ac{ULSR} of 99.7\% across trials. Inaccuracies in timing can be explained by the Apple iPhone 6+ connecting to the \ac{AP} as the user is walking up to or away from the smart home and prior to or after the times reflected in the logs.
	%		\tableUlsrResults
	
	\section{CITIoT Performance} \label{citiotPerformance}
	
	This section analyzes \ac{CITIoT}'s performance while operating against \ac{SHAA} using the response variables \ac{PT} and \ac{HDU} discussed in Section 4.3. The performance parameters are presented for the \ac{BLE} and WI-Fi components separately and \ac{CITIoT} as a whole.
	
	\subsection{\ac{PT}}
	The \ac{PT} response variable measures the average processing time for each component and the \ac{CITIoT} tool as a whole. Each component and trial processes a different number of packets so \ac{PT} is normalized by calculating the average \ac{PT} per 25,000 packets. The individual times are calculated while that component is operating alone. In operation, the \ac{BLE} and Wi-Fi components operate simultaneously in two different processes. Therefore, the \ac{CITIoT} \ac{NPT} is calculated when both components are operating concurrently. Table~\ref{} provides the \ac{NPT} results for each component and the tool as a whole. The first trial does not have a \ac{BLE} component, so that trial's timing is not considered in \ac{CITIoT}'s total average, but is included for the Wi-Fi units' averages. 
	
	The mean \ac{NPT} for the \ac{BLE} component of \ac{CITIoT} operating alone is 24.1 seconds per 25,000 packets. On average, one hour of captured \ac{BLE} traffic resulted in about 441.75 thousand packets and took the \ac{BLE} component of the tool approximately 7 minutes to process. The standard deviation of .2 indicates that the individual trials' \ac{NPT} did not vary considerably.
	
	The average \ac{NPT} for the Wi-Fi component of \ac{CITIoT} is 22.0 seconds per 25,000 packets. On average, one hour of captured Wi-Fi traffic resulted in about 417.73 thousand packets and took the Wi-Fi component of the tool approximately 6 minutes to process. The standard deviation of .7 indicates that the individual trials' \ac{NPT} did not vary considerably.
	
	The average \ac{NPT} presented for \ac{CITIoT} as a whole assumes the \ac{BLE} and Wi-Fi components are operating simultaneously. On average, the \ac{NPT} is  seconds per 25,000 packets.
	
	\subsection{\ac{HDU}}
	
	
	\section{Chapter Summary}
	
	
	\todos
	\backmatter
	\singlespace
	\bibliographystyle{plain}
	\bibliography{../Back/myReferences} 
	\clearpage
	
\end{document}

